import userEvent from "@testing-library/user-event";
import { findByRole } from "@testing-library/dom";
import { Button } from "../Button";
import { colors } from "../colors";
import { Menu } from "../Menu";
import { MenuItem } from "../MenuItem";
import { MenuDivider } from "../MenuDivider";
import { MenuHeading } from "../MenuHeading";
import {
  Description,
  Meta,
  Story,
  Props,
  Preview,
} from "@storybook/addon-docs/blocks";
import { IconAstronaut1 } from "../icons/IconAstronaut1";
import { IconAstronaut2 } from "../icons/IconAstronaut2";
import { IconAstronaut3 } from "../icons/IconAstronaut3";
import { IconLander } from "../icons/IconLander";
import { IconPlanet3 } from "../icons/IconPlanet3";
import { IconShip3 } from "../icons/IconShip3";
import { IconCheck } from "../icons/IconCheck";

<Meta title="Components|Menu" />

# Menu

<Description
  of={Menu}
  markdown="**Menus** provide a mechanic to style a group of `MenuItem` elements in a single place"
/>

## Simple Menu

The simple menu provides a list of options for a user to choose from and updates the button or select button with the choice the user has selected.

<Preview>
  <Story name="Simple Menu">
    <Menu className="bg-black text-white" theme="dark">
      <MenuItem>Root</MenuItem>
      <MenuItem selected>Objects</MenuItem>
      <MenuItem>Inputs</MenuItem>
      <MenuItem>Interfaces</MenuItem>
      <MenuItem>Unions</MenuItem>
      <MenuItem>Scalars and Enums</MenuItem>
    </Menu>
  </Story>
</Preview>

## Colors

Menus support a `color` prop that will specify the color of the active/selecrted state and formulalicly calculate the hover color depending on theme.

### Light

<Preview>
  <Story name="Colors, light theme">
    <Menu color={colors.red.base} theme="light">
      <MenuItem>Root</MenuItem>
      <MenuItem selected>Objects</MenuItem>
      <MenuItem>Inputs</MenuItem>
      <MenuItem>Interfaces</MenuItem>
      <MenuItem>Unions</MenuItem>
      <MenuItem>Scalars and Enums</MenuItem>
    </Menu>
  </Story>
</Preview>

### Dark

<Preview>
  <Story name="Colors, dark theme">
    <div style={{ backgroundColor: "black", color: "white" }}>
      <Menu color={colors.red.base} theme="dark">
        <MenuItem>Root</MenuItem>
        <MenuItem selected>Objects</MenuItem>
        <MenuItem>Inputs</MenuItem>
        <MenuItem>Interfaces</MenuItem>
        <MenuItem>Unions</MenuItem>
        <MenuItem>Scalars and Enums</MenuItem>
      </Menu>
    </div>
  </Story>
</Preview>

## Segmented Menu

The segmented menu provides a way to group related options. This can be achieved
by a divider and in other cases, headers can be used to group similar
information and provide a nice visual grouping.

<Preview>
  <Story name="Segmented Menu">
    <Menu>
      <MenuItem>All Types</MenuItem>
      <MenuDivider />
      <MenuItem>Root</MenuItem>
      <MenuItem>Objects</MenuItem>
      <MenuItem>Inputs</MenuItem>
      <MenuItem>Interfaces</MenuItem>
      <MenuItem>Unions</MenuItem>
      <MenuItem>Scalars and Enums</MenuItem>
      <MenuDivider />
      <MenuItem>Deprecations</MenuItem>
    </Menu>
  </Story>
</Preview>

## Header

<Preview>
  <Story name="Heading">
    <Menu>
      <MenuHeading count={5}>Filter by</MenuHeading>
      <MenuItem>Root</MenuItem>
      <MenuItem>Objects</MenuItem>
      <MenuItem>Inputs</MenuItem>
      <MenuItem>Interfaces</MenuItem>
      <MenuItem>Unions</MenuItem>
      <MenuItem>Scalars and Enums</MenuItem>
    </Menu>
  </Story>
</Preview>

## Icons

### `startIcon`

MenuItems can take a `startIcon` to display an icon to the left

<Preview>
  <Story name="startIcon">
    <Menu>
      <MenuItem
        startIcon={
          <IconAstronaut1
            style={{ width: "100%", height: "100%" }}
            weight="thin"
          />
        }
      >
        Cones
      </MenuItem>
      <MenuItem
        startIcon={
          <IconAstronaut2
            style={{ width: "100%", height: "100%" }}
            weight="thin"
          />
        }
      >
        Rhomboid
      </MenuItem>
      <MenuItem
        startIcon={
          <IconAstronaut3
            style={{ width: "100%", height: "100%" }}
            weight="thin"
          />
        }
      >
        Cubes
      </MenuItem>
      <MenuItem
        startIcon={
          <IconLander style={{ width: "100%", height: "100%" }} weight="thin" />
        }
      >
        Diamonds
      </MenuItem>
      <MenuItem
        startIcon={
          <IconPlanet3
            style={{ width: "100%", height: "100%" }}
            weight="thin"
          />
        }
      >
        Cylinders
      </MenuItem>
      <MenuItem
        startIcon={
          <IconShip3 style={{ width: "100%", height: "100%" }} weight="thin" />
        }
      >
        Pyramids
      </MenuItem>
    </Menu>
  </Story>
</Preview>

### `endIcon`

`MenuItem`s can take an `endIcon` prop to place an icon on the right

<Preview>
  <Story name="endIcon">
    <Menu>
      <MenuItem
        endIcon={
          <IconAstronaut1
            style={{ width: "100%", height: "100%" }}
            weight="thin"
          />
        }
      >
        Cones
      </MenuItem>
      <MenuItem
        endIcon={
          <IconAstronaut2
            style={{ width: "100%", height: "100%" }}
            weight="thin"
          />
        }
      >
        Rhomboid
      </MenuItem>
      <MenuItem
        endIcon={
          <IconAstronaut3
            style={{ width: "100%", height: "100%" }}
            weight="thin"
          />
        }
      >
        Cubes
      </MenuItem>
      <MenuItem
        endIcon={
          <IconLander style={{ width: "100%", height: "100%" }} weight="thin" />
        }
      >
        Diamonds
      </MenuItem>
      <MenuItem
        endIcon={
          <IconPlanet3
            style={{ width: "100%", height: "100%" }}
            weight="thin"
          />
        }
      >
        Cylinders
      </MenuItem>
      <MenuItem
        endIcon={
          <IconShip3 style={{ width: "100%", height: "100%" }} weight="thin" />
        }
      >
        Pyramids
      </MenuItem>
    </Menu>
  </Story>
</Preview>

### Multiline

Icons will be vertically centered when menu item content wraps more than one line

<Preview>
  <Story name="Multiline icons">
    <Menu iconSize="small">
      <MenuItem
        endIcon={
          <IconAstronaut1
            style={{ width: "100%", height: "100%" }}
            weight="thin"
          />
        }
      >
        <div>Cones</div>
        <div>subtext</div>
      </MenuItem>
      <MenuItem
        endIcon={
          <IconAstronaut2
            style={{ width: "100%", height: "100%" }}
            weight="thin"
          />
        }
      >
        <div>Rhomboid</div>
        <div>subtext</div>
      </MenuItem>
      <MenuItem
        endIcon={
          <IconAstronaut3
            style={{ width: "100%", height: "100%" }}
            weight="thin"
          />
        }
      >
        <div>Cubes</div>
        <div>subtext</div>
      </MenuItem>
      <MenuItem
        endIcon={
          <IconLander style={{ width: "100%", height: "100%" }} weight="thin" />
        }
      >
        <div>Diamonds</div>
        <div>subtext</div>
      </MenuItem>
      <MenuItem
        endIcon={
          <IconPlanet3
            style={{ width: "100%", height: "100%" }}
            weight="thin"
          />
        }
      >
        <div>Cylinders</div>
        <div>subtext</div>
      </MenuItem>
      <MenuItem
        endIcon={
          <IconShip3 style={{ width: "100%", height: "100%" }} weight="thin" />
        }
      >
        Pyramids
      </MenuItem>
    </Menu>
  </Story>
</Preview>

## Icons with custom sizes

Menus support several icon sizes

### Small

<Preview>
  <Story name="Small icons">
    <Menu iconSize="small">
      <MenuHeading startIcon={null}>mdg-private-graphs</MenuHeading>
      <MenuItem startIcon={null}>apollo-day-nyc</MenuItem>
      <MenuItem startIcon={null} selected>
        engine
      </MenuItem>
      <MenuItem startIcon={null}>galaxy-eu-west</MenuItem>
      <MenuItem
        startIcon={
          <IconCheck
            style={{
              color: colors.blue.base,
              width: "100%",
              height: "100%",
            }}
          />
        }
      >
        galaxy-ties
      </MenuItem>
      <MenuItem startIcon={null}>space-explorer</MenuItem>
      <MenuItem startIcon={null}>z-end-to-end-ingestion-20</MenuItem>
    </Menu>
  </Story>
</Preview>

## Truncation

Items should be truncated properly

export const MenuItemWithContentHuggingSides = ({
  startContent,
  endContent,
}) => {
  return (
    <div style={{ width: "100%", display: "flex" }}>
      <span
        style={{
          flex: 1,
          overflow: "hidden",
          textOverflow: "ellipsis",
          whiteSpace: "nowrap",
        }}
      >
        {startContent}
      </span>
      <span
        style={{
          marginLeft: ".5rem",
          flex: "none",
          color: colors.grey.light,
        }}
      >
        {endContent}
      </span>
    </div>
  );
};

<Preview>
  <Story name="flexbox truncation">
    <div style={{ maxWidth: 280 }}>
      <Menu iconSize="small">
        <MenuHeading startIcon={null}>mdg-private-graphs</MenuHeading>
        <MenuItem startIcon={null}>
          <MenuItemWithContentHuggingSides
            startContent="really_long_test_name_really_long_test_name"
            endContent="0 rpm"
          />
        </MenuItem>
        <MenuItem startIcon={null} selected>
          <MenuItemWithContentHuggingSides
            startContent="engine"
            endContent="1.9k rm"
          />
        </MenuItem>
        <MenuItem
          startIcon={
            <IconCheck
              style={{
                color: colors.blue.base,
                width: "100%",
                height: "100%",
              }}
            />
          }
        >
          <MenuItemWithContentHuggingSides
            startContent="galaxy-eu-west"
            endContent="0 rm"
          />
        </MenuItem>
      </Menu>
    </div>
  </Story>
</Preview>

## Colors Menu

Menu colors can be configured on the `Menu` component. Nested menus will inherit colors defined in antecendent `Menu`s and hover colors will be automatically calcualted depending on the theme.

<Preview>
  <Story name="color-configuration">
    <Menu color={colors.red.base}>
      <MenuItem>Root</MenuItem>
      <MenuItem selected>Objects</MenuItem>
      <MenuItem>Inputs</MenuItem>
      <MenuItem>Interfaces</MenuItem>
      <MenuItem>Unions</MenuItem>
      <MenuItem>Scalars and Enums</MenuItem>
    </Menu>
  </Story>
</Preview>

## Props

### `Menu`

<Props of={Menu} />

### `MenuItem`

<Props of={MenuItem} />

### `MenuHeading`

<Props of={MenuHeading} />

### `MenuDivider`

<Props of={MenuDivider} />
